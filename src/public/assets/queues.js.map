{"version":3,"sources":["webpack:///webpack/bootstrap 769199d08337f301b4f1","webpack:///./src/public/javascript/utility.js","webpack:///./src/public/javascript/local_settings.js","webpack:///./src/public/javascript/api.js","webpack:///./src/public/javascript/interactions.js","webpack:///./src/public/javascript/queue-dashboard.js","webpack:///./src/public/javascript/gizmo.js"],"names":["error","err","message","newDate","Date","setTime","now","dateString","toTimeString","console","log","$","text","formatAMPM","date","hours","getHours","minutes","getMinutes","seconds","getSeconds","ampm","strTime","getAuthString","username","password","auth","btoa","API_URL","getStatistics","filter","response","request","json","queueStats","getData","getReportResults","params","type","getFieldList","updateField","field","parameters","endpoint","val","url","method","apiURL","requestOptions","headers","credentials","body","JSON","stringify","fetch","then","status","notifyServer504","ok","bodyText","Error","statusText","jsonToReturnValue","getFaultStringFromData","data","getParameters","requestType","user","pass","document","ready","click","removeClass","addClass","event","preventDefault","timeout","gizmo","clearTimeout","runQueueDashboard","id","closest","attr","thisgizmo","gizmos","showQueueList","table","next","createQueueList","eventLoop","interval","slData","time","start","moment","format","end","refreshView","setTimeout","serviceLevelData","each","i","gizmoElement","thisGizmo","name","skills","skillFilter","queueList","callsInQueue","maxWait","agentsLoggedIn","agentsNotReady","agentsOnCall","agentsReady","serviceLevel","callsOffered","abandons","length","queue","includes","Math","max","split","metrics","reduce","totals","current","skill","calls","push","skillName","formatWaitTime","waitString","SLpercent","round","abandonRate","find","empty","sort","a","b","thead","createElement","th1","appendChild","createTextNode","className","th2","th3","append","forEach","tr","td1","td2","td3","wait","setSeconds","toISOString","substr","jsonToViewData","includeFields","columns","rows","row","newRow","j","indexOf","slice","GizmoManager","openGizmoId","build","template","getElementById","cloneNode","classList","remove","add","nextGizmoId","html","setupInteractions","gizmoID","save","updateCurrent","skillStringToArray","css","bind","toggleClass","lastId","Object","keys","map","closeModal","deleteGizmo","window","target","is","updateSkillFilter","addGizmo","newID","localStorage","setItem","load","getItem","parse","skillString","trim"],"mappings":"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","file":"queues.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 74);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 769199d08337f301b4f1","\r\n// Send out an error alert in console and on the page.\r\nexport function error(err, message='') {\r\n    // timestamp\r\n    let newDate = new Date();\r\n    newDate.setTime(Date.now());\r\n    let dateString = newDate.toTimeString();\r\n    console.log(dateString);\r\n\r\n    // Post to page\r\n    $('#message').text(`Whoops! An error occurred. ${err.message} ${message}`);\r\n    console.log('Error log:');\r\n    console.error(err);\r\n}\r\n\r\n// Nicely formatted time\r\nexport function formatAMPM(date) {\r\n    let hours = date.getHours();\r\n    let minutes = date.getMinutes();\r\n    let seconds = date.getSeconds();\r\n    let ampm = hours >= 12 ? 'PM' : 'AM';\r\n    hours = hours % 12;\r\n    hours = hours ? hours : 12; // the hour '0' should be '12'\r\n    minutes = minutes < 10 ? '0'+minutes : minutes;\r\n    seconds = seconds < 10 ? '0'+seconds : seconds;\r\n    let strTime = hours + ':' + minutes + ':' + seconds + ' ' + ampm;\r\n    return strTime;\r\n}\r\n\r\n\r\n// Combines username and password, then encodes in Base 64. Yum!\r\nexport function getAuthString(username, password) {\r\n   let auth = username + ':' + password;\r\n   return btoa(auth);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/javascript/utility.js","export const API_URL = 'http://localhost:3000/api/';\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/javascript/local_settings.js","import { error, getAuthString } from './utility.js';\r\nimport { API_URL } from './local_settings.js';\r\n\r\n////////////////////////////////////////////////////////////////\r\n// Functions to retrieve and extract data from Five9.\r\n// These functions interact with our server, which houses data\r\n// and formats data originating in Five9 reports.\r\n////////////////////////////////////////////////////////////////\r\n\r\n\r\n// Get agent/ACD statistics\r\nexport async function getStatistics(filter) {\r\n    const response = await request(filter, 'statistics');\r\n    return response.json();\r\n}\r\n\r\n\r\n// Get real-time stats\r\nexport async function queueStats() {\r\n    return getData({}, 'queue-stats');\r\n}\r\n\r\n\r\n/**\r\n * Get CSV string of report results from Five9\r\n * @param  {Object} params\r\n * @param  {String} type   endpoint: `maps` or `service-level`\r\n * @return {Object}        JSON data\r\n */\r\nexport function getReportResults(params, type) {\r\n    return getData(params, `reports/${type}`);\r\n}\r\n\r\n\r\n/**\r\n * List of available fields for widgets.\r\n * @return {Promise} resolves to array of field objects\r\n */\r\nexport async function getFieldList() {\r\n    let response = await request({}, 'fields', 'GET');\r\n    return response.json();\r\n}\r\n/**\r\n * Updates a field on server.\r\n * @param  {Object}  field new object\r\n * @return {Promise} resolves to array of field objects\r\n */\r\nexport async function updateField(field) {\r\n    let response = await request({field: field}, 'fields', 'PUT');\r\n    return response.text();\r\n}\r\n\r\n\r\n/**\r\n *  Helper function that pulls credentials from DOM, then makes request to server.\r\n * @param  {Object} parameters POSTed to server\r\n * @param  {String} endpoint   at server's API\r\n * @return {Object}            JSON data\r\n */\r\nasync function getData(parameters, endpoint) {\r\n    const auth = getAuthString($('.username').val(), $('.password').val());\r\n    parameters['authorization'] = auth;\r\n\r\n    const response = await request(parameters, endpoint);\r\n    return await response.json();\r\n}\r\n\r\n// Make a request to server with given parameters (from getParameters)\r\nasync function request(parameters, url='statistics', method='POST') {\r\n    const apiURL = API_URL + url; // defined in api_url.js\r\n\r\n    const requestOptions = {\r\n        method: method,\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json'\r\n        },\r\n        credentials: 'include'\r\n    }\r\n    if (method != 'GET') {\r\n        requestOptions.body = JSON.stringify(parameters);\r\n    }\r\n\r\n    return fetch(apiURL, requestOptions)\r\n        .then(async (response) => {\r\n            if (response.status == 504) notifyServer504(parameters, url); // debugging\r\n            if (!response.ok) {\r\n                let bodyText = await response.text();\r\n                throw new Error(`Server responded with ${response.status} ${response.statusText}: ${bodyText}`);\r\n            }\r\n            return response;\r\n        }).then((response) => {\r\n            return response;\r\n        });\r\n}\r\n\r\nasync function notifyServer504() {\r\n    return fetch(API_URL + 'notify-504');\r\n}\r\n\r\n\r\n// Gets the actual returned value/data out of JSON from the server.\r\nfunction jsonToReturnValue(json, type) {\r\n    return json['env:Envelope']['env:Body'][0]['ns2:'+type+'Response'][0]['return'][0];\r\n}\r\n\r\n// takes JSON from server and returns text within 'faultstring' tag (if existant)\r\nfunction getFaultStringFromData(data) {\r\n    try {\r\n        return data['env:Envelope']['env:Body'][0]['env:Fault'][0]['faultstring'];\r\n    } catch (err) {\r\n        return '';\r\n    }\r\n}\r\n\r\n// Given a requestType, returns JSON to submit to server in POST request.\r\n// requestType should match Five9 API command.\r\nexport function getParameters(requestType) {\r\n    let params = {};\r\n    // Initiate session\r\n    if (requestType == 'setSessionParameters') {\r\n        params = {\r\n            'service': 'setSessionParameters',\r\n            'settings': [ {\r\n                'viewSettings': [\r\n                    { 'idleTimeOut': 1800 },\r\n                    { 'statisticsRange': 'CurrentDay' },\r\n                    { 'rollingPeriod': 'Minutes10' }\r\n                ]\r\n            } ]\r\n        }\r\n    }\r\n    // Get real-time call stats\r\n    if (requestType == 'getStatistics') {\r\n        params = {\r\n            'service': 'getStatistics',\r\n            'settings': [ {\r\n                'statisticType': 'ACDStatus'\r\n            } ]\r\n        }\r\n    }\r\n\r\n    // Credentials\r\n    let user = $('.username').val();\r\n    let pass = $('.password').val();\r\n    params['authorization'] = getAuthString(user, pass);\r\n\r\n    return params;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/javascript/api.js","// Handles UI interaction for login form\r\n\r\n$(document).ready(() => {\r\n    // show Login form\r\n    $('.credentials-cover-toggle').click(() => {\r\n        $('.credentials-form').removeClass('out-of-the-way');\r\n        $('.credentials-cover').addClass('out-of-the-way');\r\n    });\r\n\r\n    // listen for sign-in button press\r\n    $('.begin-session').click(async (event) => {\r\n        // prevent redirection\r\n        event.preventDefault();\r\n        \r\n        // clear Five9 credentials box and update Login button text\r\n        $('.credentials-form').addClass('out-of-the-way');\r\n        $('.credentials-cover').removeClass('out-of-the-way');\r\n        $('.credentials-cover-toggle').text('Logged In');\r\n    });\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/javascript/interactions.js","import { error, formatAMPM } from './utility';\r\nimport * as api from './api';\r\nimport './interactions';\r\nimport GizmoManager from './gizmo';\r\n\r\n// timeout to pause event loop when needed\r\nlet timeout = null;\r\n\r\n// Object to manage the gizmos (queue widgets)\r\nlet gizmo = null;\r\n\r\n$(document).ready(() => {\r\n    gizmo = new GizmoManager();\r\n\r\n    // listen for sign-in button press\r\n    $('.begin-session').click(async (event) => {\r\n        // prevent redirection\r\n        event.preventDefault();\r\n        // stop any current event loops running\r\n        if (timeout != null) {\r\n            clearTimeout(timeout);\r\n        }\r\n\r\n        // begin updating data & page every few seconds\r\n        try {\r\n            runQueueDashboard();\r\n        } catch (err) {\r\n            error(err, 'Error occurred while queue dashboard was running.');\r\n        }\r\n    });\r\n\r\n    // Update displayed queue list when user clicks button\r\n    $('.show-skills-list').click(function (event) {\r\n        const id = $(this).closest('.gizmo').attr('id');\r\n        const thisgizmo = gizmo.gizmos[id];\r\n        thisgizmo.showQueueList = !thisgizmo.showQueueList;\r\n        const table = $(this).next('table.queue-list');\r\n        createQueueList(thisgizmo, table);\r\n    });\r\n});\r\n\r\n\r\nasync function runQueueDashboard() {\r\n    async function eventLoop(interval) {\r\n        // Get the current queue data\r\n        let data, slData;\r\n        let time = {};\r\n\r\n        try {\r\n            // Retrieve current queue stats\r\n            data = await api.queueStats();\r\n\r\n            // Get SL stats\r\n            time.start = moment().format('YYYY-MM-DD') + 'T00:00:00';\r\n            time.end   = moment().format('YYYY-MM-DD') + 'T23:59:59';\r\n            try {\r\n                slData = await api.getReportResults(time, 'service-level');\r\n                // slData = [];\r\n            } catch (err) {\r\n                error(err, `An error occurred when getting service level data: ${err}`);\r\n                slData = [];\r\n            }\r\n\r\n            // Update the view / DOM\r\n            refreshView(data, slData);\r\n        } catch (err) {\r\n            error(err);\r\n        }\r\n\r\n        // restart loop\r\n        timeout = setTimeout(() => {\r\n            eventLoop(interval);\r\n        }, interval);\r\n    }\r\n\r\n    // Refresh every 20 seconds.\r\n    eventLoop(20000);\r\n}\r\n\r\n\r\n\r\n// Takes nicely formatted data. Updates dashboard view.\r\n// ${data} : ACD stats (current queue info)\r\n// ${serviceLevel} : service level report\r\nfunction refreshView(data, serviceLevelData) {\r\n    // update each gizmo on the screen\r\n    $('.gizmo').each((i, gizmoElement) => {\r\n        const thisGizmo = gizmo.gizmos[gizmoElement.id];\r\n        let name = thisGizmo.name;\r\n        let skills = thisGizmo.skillFilter;\r\n        // Clear old queue list from gizmo\r\n        thisGizmo.queueList = [];\r\n\r\n        // Determine calls and agent stats for this gizmo's skills\r\n        let callsInQueue = 0,\r\n            maxWait = 0,\r\n            agentsLoggedIn = 0,\r\n            agentsNotReady = 0,\r\n            agentsOnCall = 0,\r\n            agentsReady = 0,\r\n            serviceLevel = 0,\r\n            callsOffered = 0,\r\n            abandons = 0;\r\n\r\n        for (let i=0; i < data.length; i++) {\r\n            let queue = data[i];\r\n            // Include skills in gizmo filter, or all skills if none are in filter\r\n            if (skills.includes(queue['SkillName']) || skills.length == 0) {\r\n                // Real-time queue metrics\r\n                callsInQueue += queue['CallsInQueue'];\r\n                maxWait = Math.max(maxWait, queue['CurrentLongestQueueTime']);\r\n                agentsLoggedIn = Math.max(agentsLoggedIn, queue['AgentsLoggedIn'].split(' ')[0]*1);\r\n                agentsNotReady = Math.max(agentsNotReady, queue['AgentsNotReadyForCalls']);\r\n                agentsOnCall = Math.max(agentsOnCall, queue['AgentsOnCall']);\r\n                agentsReady = Math.max(agentsReady, queue['AgentsReadyForCalls']);\r\n\r\n                // Calculate SL and abandon rate\r\n                let metrics = serviceLevelData.reduce((totals, current) => {\r\n                    if (current.skill == queue['SkillName']) {\r\n                        totals.serviceLevel += current.serviceLevel;\r\n                        totals.calls += current.calls;\r\n                        totals.abandons += current.abandons;\r\n                    }\r\n                    return totals;\r\n                }, { serviceLevel: 0, calls: 0, abandons: 0 });\r\n                serviceLevel += metrics.serviceLevel;\r\n                callsOffered += metrics.calls;\r\n                abandons += metrics.abandons;\r\n\r\n                // Add to list of skills in queue\r\n                if (queue['CallsInQueue'] > 0) {\r\n                    thisGizmo.queueList.push({\r\n                        skillName: queue['SkillName'],\r\n                        callsInQueue: queue['CallsInQueue'],\r\n                        maxWait: formatWaitTime(queue['CurrentLongestQueueTime'])\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        // Format wait time from seconds to MM:SS or HH:MM:SS\r\n        let waitString = formatWaitTime(maxWait);\r\n\r\n        // Update metrics\r\n        let SLpercent = callsOffered == 0\r\n            ? 'N/A'\r\n            : Math.round(100 * serviceLevel / callsOffered) + '%';\r\n        let abandonRate = callsOffered == 0\r\n            ? 'N/A'\r\n            : Math.round(100 * abandons / callsOffered) + '%';\r\n        $(gizmoElement).find('.metric.service-level').text(SLpercent);\r\n        $(gizmoElement).find('.metric.abandon-rate').text(abandonRate);\r\n        $(gizmoElement).find('.calls-in-sl').text(serviceLevel);\r\n        $(gizmoElement).find('.calls-out-of-sl').text(callsOffered - serviceLevel);\r\n\r\n        $(gizmoElement).find('.metric.calls-in-queue').text(callsInQueue);\r\n        $(gizmoElement).find('.metric.max-wait').text(waitString);\r\n        $(gizmoElement).find('.agents-logged-in').text(agentsLoggedIn);\r\n        $(gizmoElement).find('.agents-not-ready-for-calls').text(agentsNotReady);\r\n        $(gizmoElement).find('.agents-on-call').text(agentsOnCall);\r\n        $(gizmoElement).find('.agents-ready-for-calls').text(agentsReady);\r\n\r\n        // Update queue list, if showing\r\n        if (thisGizmo.showQueueList) {\r\n            const table = $(gizmoElement).find('.queue-list');\r\n            createQueueList(thisGizmo, table);\r\n        }\r\n    }); // gizmo.forEach\r\n\r\n    // Clear old messages\r\n    $('#message').text(' ');\r\n\r\n    // Update clock\r\n    $('.clock').text(formatAMPM(new Date()));\r\n}\r\n\r\n\r\n// Update queue list in DOM\r\n// ${gizmo} object to build list on. ${table} element storing list.\r\nfunction createQueueList(thisGizmo, table) {\r\n    table.empty(); // clear old list\r\n\r\n    // anything to list?\r\n    if (thisGizmo.queueList.length == 0) return;\r\n\r\n    // Sort by max wait time\r\n    thisGizmo.queueList.sort((a, b) => a.maxWait > b.maxWait ? -1 : 1);\r\n\r\n    // Add headers\r\n    const thead = document.createElement('thead');\r\n    const th1 = document.createElement('th');\r\n    th1.appendChild(document.createTextNode('Skill Name'));\r\n    th1.className += ' type-text';\r\n    const th2 = document.createElement('th');\r\n    th2.appendChild(document.createTextNode('Calls'));\r\n    th2.className += ' type-number';\r\n    const th3 = document.createElement('th');\r\n    th3.appendChild(document.createTextNode('Max Wait'));\r\n    th3.className += ' type-number';\r\n    thead.appendChild(th1); thead.appendChild(th2); thead.appendChild(th3);\r\n    table.append(thead);\r\n\r\n    // Update DOM from queueList\r\n    thisGizmo.queueList.forEach((queue) => {\r\n        const tr = document.createElement('tr');\r\n        const td1 = document.createElement('td');\r\n        td1.appendChild(document.createTextNode(queue.skillName));\r\n        td1.className += ' type-text';\r\n        const td2 = document.createElement('td');\r\n        td2.appendChild(document.createTextNode(queue.callsInQueue));\r\n        td2.className += ' type-number';\r\n        const td3 = document.createElement('td');\r\n        td3.appendChild(document.createTextNode(queue.maxWait));\r\n        td3.className += ' type-number';\r\n        tr.appendChild(td1); tr.appendChild(td2); tr.appendChild(td3);\r\n        table.append(tr);\r\n    });\r\n}\r\n\r\n// Turns seconds into nicely formatted MM:SS or HH:MM:SS\r\nfunction formatWaitTime(seconds) {\r\n    const wait = new Date(null);\r\n    wait.setSeconds(seconds);\r\n    if (seconds < 3600) { // MM:SS\r\n        return wait.toISOString().substr(14, 5);\r\n    }\r\n    return wait.toISOString().substr(11, 8); // HH:MM:SS\r\n}\r\n\r\n// Return formatted column / key assignments\r\n// Takes JSON generated from original Five9 SOAP API response\r\nfunction jsonToViewData(json,\r\n        includeFields=['Skill Name', 'Calls In Queue',\r\n                        'Current Longest Queue Time', 'Agents Logged In',\r\n                        'Agents Not Ready For Calls', 'Agents On Call',\r\n                        'Agents Ready For Calls']) {\r\n    let columns = json['columns'][0]['values'][0]['data'];\r\n    let rows = json['rows'];\r\n    let data = [];\r\n\r\n    for (let i=0; i < rows.length; i++) {\r\n        let row = rows[i]['values'][0]['data'];\r\n        let newRow = {};\r\n        for (let j=0; j < includeFields.length; j++) {\r\n            let field = includeFields[j];\r\n            newRow[field] = row[columns.indexOf(field)];\r\n            // trim extra 0's to fix time formatting (to seconds)\r\n            if (field == 'Current Longest Queue Time')\r\n                newRow[field] = newRow[field].slice(0, -3);\r\n        }\r\n        data.push(newRow);\r\n    }\r\n    return data;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/javascript/queue-dashboard.js","\r\n// Handling of queue gizmo widgets.\r\n// Manages state and DOM (modals to edit skills & name).\r\nexport default function GizmoManager() {\r\n    // Object storing info on filters & names for each gizmo-widget\r\n    this.gizmos = null;\r\n    // which gizmo has a menu open?\r\n    this.openGizmoId = null;\r\n\r\n    this.build = function(id=null) {\r\n        let template = document.getElementById('gizmo-template');\r\n        let gizmo = template.cloneNode(true);\r\n\r\n        // update classes to those of a live, wild gizmo\r\n        gizmo.classList.remove('template');\r\n        gizmo.classList.add('gizmo');\r\n\r\n        // Create an ID and append to DOM\r\n        if (id == null) {\r\n            id = this.nextGizmoId();\r\n        }\r\n        gizmo.id = id;\r\n        $('.gizmo-wrapper').append(gizmo);\r\n\r\n        // Add to gizmos object, but don't overwrite existing ones\r\n        if (!this.gizmos[id]) {\r\n            this.gizmos[id] = {\r\n                name: 'New one!',\r\n                skillFilter: []\r\n            }\r\n        }\r\n        // set name for DOM\r\n        $(gizmo).find('.department-name').html(this.gizmos[id].name);\r\n\r\n        this.setupInteractions(id);\r\n        return id;\r\n    }\r\n\r\n    this.remove = function(gizmoID) {\r\n        document.getElementById(gizmoID).remove();\r\n        delete this.gizmos[gizmoID];\r\n        this.save();\r\n    }\r\n\r\n    // Which gizmo is currently edited in the skill menu? This function will\r\n    // update that gizmo's attributes.\r\n    this.updateCurrent = function(name, skills) {\r\n        this.gizmos[this.openGizmoId].name        = name;\r\n        this.gizmos[this.openGizmoId].skillFilter = skillStringToArray(skills);\r\n    }\r\n\r\n    // Set up menu interactions for a gizmo with the given ID\r\n    this.setupInteractions = function(id) {\r\n        let gizmo = $('#' + id);\r\n\r\n        // Skills menu\r\n        gizmo.find('.skills-edit-toggle').click(function (event) {\r\n            // Show the modal...\r\n            $('.modal').css('display', 'block');\r\n            // Track currently open menu...\r\n            this.openGizmoId = id;\r\n            // And set modal values to match this gizmo\r\n            $('.modal').find('.gizmo-name').val(this.gizmos[id].name);\r\n            $('.modal').find('.skills').val(this.gizmos[id].skillFilter);\r\n        }.bind(this));\r\n\r\n        // Show/hide queue list\r\n        this.gizmos[id].showQueueList = false;\r\n        gizmo.find('.show-skills-list').click(function (event) {\r\n            gizmo.find('.show-skills-list').toggleClass('selected');\r\n            gizmo.find('.queue-list').toggleClass('hidden');\r\n        }.bind(this));\r\n    }\r\n\r\n    // Get a new ID string in the form 'gizmo-<integer>'\r\n    this.nextGizmoId = function() {\r\n        if (!this.gizmos) return 'gizmo-0';\r\n        let lastId = Math.max(\r\n            ...Object.keys(this.gizmos).map((id) =>\r\n                id.split('-')[1]\r\n            )\r\n        );\r\n        return `gizmo-${lastId + 1}`;\r\n    };\r\n\r\n    // set up modal window for editing skills.\r\n    $('.modal').find('.close, .cancel, .save').click(function closeModal() {\r\n        $('.modal').css('display', 'none')\r\n    });\r\n    $('.modal').find('.remove').click(function deleteGizmo() {\r\n        $('.modal').css('display', 'none');\r\n        this.remove(this.openGizmoId);\r\n    }.bind(this));\r\n    $(window).click(function closeModal(event) {\r\n        if ($(event.target).is('.modal'))\r\n            $('.modal').css('display', 'none');\r\n    }.bind(this));\r\n    // Listen for skill filter updates\r\n    $('.modal .save').click(function updateSkillFilter() {\r\n        const name   = $('.modal .gizmo-name').val();\r\n        const skills = $('.modal .skills').val();\r\n        $('#' + this.openGizmoId).find('.department-name').html(name);\r\n        this.updateCurrent(name, skills);\r\n        this.save();\r\n    }.bind(this));\r\n    // Listen for add-gizmo button\r\n    $('.add-gizmo').click(function addGizmo() {\r\n        let newID = this.build();\r\n        // save current state to local storage\r\n        this.save();\r\n    }.bind(this));\r\n\r\n\r\n    // Save gizmos to local storage\r\n    this.save = function() {\r\n        const data = JSON.stringify(this.gizmos);\r\n        localStorage.setItem('user_gizmos', data);\r\n    }\r\n\r\n    // Load gizmos from local storage on startup\r\n    this.load = function() {\r\n        let data = localStorage.getItem('user_gizmos');\r\n        if (!data) {\r\n            this.gizmos = {};\r\n        } else {\r\n            this.gizmos = JSON.parse(data);\r\n            console.log('Loading gizmos:', this.gizmos);\r\n            // Build view\r\n            for (const id of Object.keys(this.gizmos)) {\r\n                this.build(id);\r\n            };\r\n        }\r\n    }\r\n\r\n    this.load();\r\n}\r\n\r\n// Breaks down \"skill1, skill2 , skill3\" string\r\n//          to ['skill1','skill2','skill3'] array\r\nfunction skillStringToArray(skillString) {\r\n    if (skillString == '') return [];\r\n    return skillString.split(',').map((skill) => skill.trim());\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/public/javascript/gizmo.js"],"sourceRoot":""}